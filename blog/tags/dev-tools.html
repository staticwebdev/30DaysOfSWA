<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="#30DaysOfSWA RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="#30DaysOfSWA Atom Feed"><title data-rh="true">3 posts tagged with &quot;dev-tools&quot; | #30DaysOfSWA</title><meta data-rh="true" property="og:image" content="https://staticwebdev.github.io/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://staticwebdev.github.io/img/logo.png"><meta data-rh="true" property="og:url" content="https://staticwebdev.github.io/blog/tags/dev-tools"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="Welcome to the Azure Static Web Apps Gallery of community-created projects! Explore the examples - or add your own!"><meta data-rh="true" property="og:title" content="3 posts tagged with &quot;dev-tools&quot; | #30DaysOfSWA"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://staticwebdev.github.io/blog/tags/dev-tools"><link data-rh="true" rel="alternate" href="https://staticwebdev.github.io/blog/tags/dev-tools" hreflang="en"><link data-rh="true" rel="alternate" href="https://staticwebdev.github.io/blog/tags/dev-tools" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.061b8712.css">
<link rel="preload" href="/assets/js/runtime~main.0dd7f00d.js" as="script">
<link rel="preload" href="/assets/js/main.29edfaee.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:#50E6FF;color:#552F99" role="banner"><div class="announcementBarContent_KsVm"><b>Joins us May 19, 2021 for the <a href="https://aka.ms/SWAanniversary"><b>#SWAanniversary</b> event!</a></b></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="#30DaysOfSWA Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="#30DaysOfSWA Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">#30DaysOfSWA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Series</a><a class="navbar__item navbar__link" href="/resources">Resources</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/showcase">Showcase</a><a href="https://github.com/orgs/staticwebdev/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussions</a><a href="https://github.com/staticwebdev/30DaysOfSWA" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_TMXw thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_V4zb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_uHd5 clean-list"><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/devtools-ado">#17: Multi-Stage Deploy with ADO</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/devtools-playwright">#16: Test Automation with Playwright</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/devtools-azure">#15: Develop with Azure Tools</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/show-and-tell">#14: Show &amp; Tell: A SWArm Of Apps</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/pwa-on-swa">#13: Hosting PWA on Static Web Apps</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/build-with-blazor">#12: Headless CMS &amp; SWA With Blazor</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/build-with-docusaurus">#11: Share Content - with Docusaurus</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/build-with-vuejs">#10: Get Creative - with Vue.js</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/build-with-react">#09: Manage Inventory - with React</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/build-with-astro">#08: Build A Blog - with Astro</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/deploying-swa">#07: Deploying SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/previewing-swa">#06: Previewing SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/securing-swa">#05: Securing SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/configuring-swa">#04: Configuring SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/api-enabling-swa">#03: API-Enabling SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/building-swa">#02: Building SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/introducing-swa">#01: Introducing SWA</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/kickoff">Kickoff #30DaysOfSWA!</a></li><li class="sidebarItem_spIe"><a class="sidebarItemLink_eqrF" href="/blog/swanniversary">It&#x27;s the SWA-anniversary!!</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>3 posts tagged with &quot;dev-tools&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/blog/devtools-ado">#17: Multi-Stage Deploy with ADO</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-05-18T00:00:00.000Z" itemprop="datePublished">May 18, 2021</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://github.com/anthonychu" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/anthonychu.png" alt="Anthony Chu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/anthonychu" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Anthony Chu</span></a></div><small class="avatar__subtitle" itemprop="description">Senior PM @Microsoft</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Welcome to <code>Week 3, Day 3</code> of <strong>#30DaysOfSWA</strong>!! </p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>From Microsoft Tech Community</h5></div><div class="admonition-content"><p>Check out the canonical version of this post on the <strong><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/multi-stage-azure-static-web-apps-deployments-with-azure-devops/ba-p/3390625" target="_blank" rel="noopener noreferrer">Apps On Azure</a></strong> Tech Community Blog along with other articles on the topic of <strong><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/bg-p/AppsonAzureBlog/label-name/Web%20Apps" target="_blank" rel="noopener noreferrer">Web Apps</a></strong></p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-well-cover">What We&#x27;ll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">​</a></h2><ul><li>Build SWA with Azure Functions API + Playwright Tests</li><li>Deploy SWA to staging environment</li><li>Automate validation of staged app with Playwright</li><li>Wait for manual approval</li><li>Deploy to production</li><li><strong>Exercise.</strong> Explore the <a href="https://github.com/anthonychu/swa-devops-pipeline-demo" target="_blank" rel="noopener noreferrer">Demo Application Source</a> and try it out!</li></ul><p><img loading="lazy" src="/assets/images/17-banner-2d8ecefdc1683370295255b3fa8a0df3.png" width="1000" height="420" class="img_E7b_"></p><p>Azure Static Web Apps recently introduced the ability to automatically configure an Azure DevOps pipeline to build and deploy your app. It&#x27;s a great way to get your app up and running quickly.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/4JkfeZp7aDk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe><p>For production applications, it&#x27;s common to first deploy an app to staging environment(s) prior to deploying to production. In this article, we&#x27;ll walk through how to configure a robust Azure DevOps pipeline that will:</p><ul><li>Build an app, Azure Functions API, and Playwright tests</li><li>Deploy the app to a staging environment</li><li>Automatically validate the staging app with the Playwright tests</li><li>Wait for a manual approval</li><li>Deploy your app to production</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="sample-application">Sample application<a class="hash-link" href="#sample-application" title="Direct link to heading">​</a></h2><p>We&#x27;ll use a .NET 6 full-stack application. </p><ul><li>Frontend: Blazor WebAssembly</li><li>Backend: Azure Functions</li><li>Tests: Playwright</li></ul><p>To follow along, import the repository into your Azure DevOps project. You can use similar steps for a Node.js app.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span><strong>Source Code Available</strong></h5></div><div class="admonition-content"><p>Check out the code at: <strong><a href="https://github.com/anthonychu/swa-devops-pipeline-demo" target="_blank" rel="noopener noreferrer">@anthonychu/swa-devops-pipeline-demo</a></strong>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-a-static-web-app-and-deployment-pipeline">Create a static web app and deployment pipeline<a class="hash-link" href="#create-a-static-web-app-and-deployment-pipeline" title="Direct link to heading">​</a></h2><p>Recently, Azure Static Web Apps added the ability to <a href="https://docs.microsoft.com/azure/static-web-apps/get-started-portal?pivots=azure-devops" target="_blank" rel="noopener noreferrer">generate an Azure DevOps pipeline</a> to deploy your app.</p><p>You can create a static web app and the deployment pipeline in a single step.</p><ol><li><p>In the Azure portal, search for and create a new static web app.</p></li><li><p>During the creation process, select &quot;Azure DevOps&quot; as the deployment source and select the DevOps repository and branch that contains the app.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168908827-22dd512a-cec7-4e27-aca4-993428f2a03e.png" alt="Create an app with Azure DevOps" class="img_E7b_"></p></li><li><p>In the build presets, select &quot;Blazor&quot;. The pre-populates the app and API folder locations.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168909032-b817a631-6e74-4739-8c4a-1ff480f955a3.png" alt="Select Blazor preset" class="img_E7b_"></p></li></ol><p>When you create the app, a new pipeline YAML file will be created in the repository. It&#x27;ll automatically run. It takes a few minutes to build and deploy the app.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168909383-0d275e2f-15ae-40e8-aa2d-56a208f7a6f4.png" alt="Location of the generated build pipeline YAML file" class="img_E7b_"></p><p>Open the pipeline YAML file in your browser or locally in an editor to see its contents. It contains a single <code>AzureStaticWebApp</code> task that automatically builds and deploys the app.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-azure-pipelines-environments">Create Azure Pipelines environments<a class="hash-link" href="#create-azure-pipelines-environments" title="Direct link to heading">​</a></h2><p>Azure Pipelines allows you to define environments. Environments are useful for adding manual approvals to your pipeline.</p><p>We&#x27;ll create two environments — Staging and Production. They&#x27;ll correspond to the two Azure Static Web Apps environments we&#x27;ll deploy to.</p><p>To create a Pipelines environment, select &quot;Environments&quot; under Pipelines.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168909775-61e3e243-c298-4fcf-a5ba-8af0a94a7a5d.png" alt="Open environments" class="img_E7b_"></p><p>Create one named &quot;Staging&quot;. Because you don&#x27;t need a manual approval for this stage, you don&#x27;t to configure anything else.</p><p>Next, create a new environment named &quot;Production&quot;. Because we want to require a manual approval before deploying to production, you can configure the environment to require a manual approval.</p><ol><li><p>In the environment&#x27;s &quot;Approvals and checks&quot;, select &quot;Approvals&quot;.</p></li><li><p>Add yourself as an approver and create the approval policy.</p></li></ol><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168910157-d32f767f-c608-4047-b0f5-66b7e4beb2f2.png" alt="Create an approval policy" class="img_E7b_"></p><p>The pipeline you&#x27;ll update later will reference these environments.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="protect-azure-static-web-apps-environments-with-a-password">Protect Azure Static Web Apps environments with a password<a class="hash-link" href="#protect-azure-static-web-apps-environments-with-a-password" title="Direct link to heading">​</a></h2><p>Azure Static Web Apps provides preview environments to let you test out your app before deploying to production.</p><p>Preview environments were intially available for pull requests in GitHub. Recently, Static Web Apps introduced the ability to arbitrary define <a href="https://docs.microsoft.com/azure/static-web-apps/named-environments" target="_blank" rel="noopener noreferrer">named preview environments</a>. For instance, we can create an environment named &quot;Staging&quot;.</p><p>Preview environments are public by default. This is great for open source projects, but sometimes we want to protect them from public access.</p><p>You can add password protection to your app&#x27;s preview environments.</p><ol><li><p>In the Azure portal, open your static web app.</p></li><li><p>In &quot;Configuration&quot;, select the &quot;General settings&quot; tab.</p></li><li><p>Select &quot;Protect staging environments only&quot; and enter a password.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168910485-02aacade-3961-41fd-aa9c-54cd14df5aab.png" alt="Protect staging environments only" class="img_E7b_"></p></li></ol><p>You also have the option to protect all environments. But in this app, we want the production environment to be accessible to the public.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="configure-the-multi-stage-pipeline">Configure the multi-stage pipeline<a class="hash-link" href="#configure-the-multi-stage-pipeline" title="Direct link to heading">​</a></h2><p>Now that we&#x27;ve configured the Azure Pipelines environments and password protection, we can configure the pipeline.</p><p>Open the pipeline YAML file in your browser or locally in an editor. Replace its contents the contents of <a href="https://github.com/anthonychu/swa-devops-pipeline-demo/blob/main/azure-pipelines.yml" target="_blank" rel="noopener noreferrer">this file</a>.</p><p>We&#x27;ll walk through the different parts of the pipeline. It has 3 main stages: build, deploy to staging, and deploy to production.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="stage-1-build-the-app">Stage 1: build the app<a class="hash-link" href="#stage-1-build-the-app" title="Direct link to heading">​</a></h3><div class="language-yaml codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-yaml codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">trigger</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">vmImage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> UseDotNet@2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install .NET SDK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">packageType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;sdk&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;6.0.x&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        dotnet publish -c Release -o &quot;$(Build.ArtifactStagingDirectory)/frontend&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build Blazor frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">workingDirectory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.DefaultWorkingDirectory)/Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        dotnet publish -c Release -o &quot;$(Build.ArtifactStagingDirectory)/api&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build Azure Functions API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">workingDirectory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.DefaultWorkingDirectory)/Api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        dotnet build -c Release -o &quot;$(Build.ArtifactStagingDirectory)/tests&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build Playwright tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">workingDirectory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.DefaultWorkingDirectory)/PlaywrightTests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PublishBuildArtifacts@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Publish artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">PathtoPublish</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$(Build.ArtifactStagingDirectory)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ArtifactName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;drop&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">publishLocation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Container&#x27;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The pipeline triggers on any changes to the <code>main</code> branch. If your app uses a different branch, you can change it.</p><p>The pipeline then builds the app, Azure Functions API, and Playwright tests. It then outputs the artifacts. The same build artifacts are deployed to all environments. This ensures that the app you tested in other environments is the same one you&#x27;re deploying to production.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="stage-2-deploy-to-staging-and-run-playwright-tests">Stage 2: deploy to staging and run Playwright tests<a class="hash-link" href="#stage-2-deploy-to-staging-and-run-playwright-tests" title="Direct link to heading">​</a></h3><div class="language-yaml codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-yaml codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy_staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy and test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Change the variable group name to match the one in the generated pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Azure</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Static</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Web</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Apps</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">calm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">coast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0df39b910</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">variable</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">runOnce</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">download</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">checkout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DownloadBuildArtifacts@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Download artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">buildType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">downloadType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">artifactName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> drop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">downloadPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.ArtifactsDirectory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AzureStaticWebApp@0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to staging environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">app_location</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frontend/wwwroot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">api_location</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">skip_app_build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">skip_api_build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">verbose</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">azure_static_web_apps_api_token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(AZURE_STATIC_WEB_APPS_API_TOKEN_CALM_COAST_0DF39B910)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">deployment_environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">workingDirectory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.ArtifactsDirectory)/drop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> UseDotNet@2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install .NET SDK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">packageType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;sdk&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;6.0.x&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                chmod -R a+x $(System.ArtifactsDirectory)/drop/tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                sudo --preserve-env=PLAYWRIGHT_BROWSERS_PATH pwsh $(System.ArtifactsDirectory)/drop/tests/playwright.ps1 install --with-deps chromium</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dotnet test $(System.ArtifactsDirectory)/drop/tests/PlaywrightTests.dll --logger trx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Playwright tests on staging app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">PLAYWRIGHT_BROWSERS_PATH</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(Build.SourcesDirectory)/browsers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">LOGIN_PASSWORD</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(LOGIN_PASSWORD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PublishTestResults@2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> succeededOrFailed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">testRunner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">testResultsFiles</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;**/*.trx&#x27;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is the most complex stage. Note that it references the &quot;Staging&quot; environment we created in the Azure Pipeline. It also references the variable group that was automatically generated when the static web app was first created. Change its name to match the variable group in the generated pipeline.</p><p>This stage starts by downloading the artifacts from the build stage.</p><p>Next, it uses the <code>AzureStaticWebApp</code> task to deploy the app to the staging environment.</p><ul><li><code>skip_app_build</code> and <code>skip_api_build</code> are set to <code>true</code> because the app and API artifacts were already built and don&#x27;t need to be built again.</li><li><code>deployment_environment</code> is set to <code>staging</code> because we want to deploy to the staging environment.</li></ul><p>After the app is deployed, the pipeline installs the .NET SDK and runs a script that installs the required dependencies for Playwright. Playwright is a testing framework that automates running tests in a browser.</p><p>After the dependencies are installed, the script runs the Playwright tests using the <code>dotnet test</code> command.</p><p>One thing to note is that we need to configure a secret variable named <code>LOGIN_PASSWORD</code>. This is the password that the user will enter when they log into the staging environment. The Playwright tests will use this password to log in when it runs tests on the staging environment.</p><p>The last step in the stage publishes the test results.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="stage-3-deploy-to-production">Stage 3: deploy to production<a class="hash-link" href="#stage-3-deploy-to-production" title="Direct link to heading">​</a></h3><div class="language-yaml codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-yaml codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy_production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Change the variable group name to match the one in the generated pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Azure</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Static</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Web</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">Apps</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">calm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">coast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0df39b910</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">variable</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">runOnce</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">download</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">checkout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DownloadBuildArtifacts@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Download artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">buildType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">downloadType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> single</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">artifactName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> drop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">downloadPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.ArtifactsDirectory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AzureStaticWebApp@0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to production environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">app_location</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frontend/wwwroot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">api_location</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">skip_app_build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">skip_api_build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">verbose</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">azure_static_web_apps_api_token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(AZURE_STATIC_WEB_APPS_API_TOKEN_CALM_COAST_0DF39B910)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">workingDirectory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $(System.ArtifactsDirectory)/drop</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This stage references the &quot;Production&quot; environment in the Azure Pipeline. Because we configured this environment to require approval, this will trigger a manual approval step before this stage is run.</p><p>Like the previous stage, this stage downloads the artifacts and deploys them with the <code>AzureStaticWebApp</code> task. This time, no <code>deployment_environment</code> is set because we want to deploy to the production environment of the static web app.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="run-the-multi-stage-pipeline">Run the multi-stage pipeline<a class="hash-link" href="#run-the-multi-stage-pipeline" title="Direct link to heading">​</a></h2><p>Now that the pipeline is set up, you can run it by saving the file. If you edited it locally, don&#x27;t forget to push it to your Azure DevOps repo.</p><p>After the &quot;Deploy to staging&quot; stage is run, you should see that the Playwright tests have been run to validate the staging environment and the results are published.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168911185-3eea2e66-0aaf-4a86-af65-956618abc6d3.png" alt="Test results" class="img_E7b_"></p><p>The pipeline run is paused because the &quot;Deploy to production&quot; stage requires an approval. </p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168912243-6450a5fa-6e95-4ac8-8f65-b1a7bc8d3e6b.png" alt="Approval step" class="img_E7b_"></p><p>When you approve the pipeline, the pipeline will run again.</p><p>After approval, the app is deployed to production.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="a-closer-look">A closer look<a class="hash-link" href="#a-closer-look" title="Direct link to heading">​</a></h2><p>Before we end this article, we want to dive a bit deeper into the Static Web Apps environments and the Playwright tests.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="azure-static-web-apps-environments">Azure Static Web Apps environments<a class="hash-link" href="#azure-static-web-apps-environments" title="Direct link to heading">​</a></h3><p>To see the environments you&#x27;ve created, click your static web app&#x27;s &quot;Environments&quot; tab in the Azure portal. You should see the production and staging environments.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/3982077/168911293-571d1057-c36b-4ff2-88df-3cdf20154318.png" alt="Static Web Apps Environments" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="playwright-tests">Playwright tests<a class="hash-link" href="#playwright-tests" title="Direct link to heading">​</a></h3><p>The Playwright tests are located in the <code>PlaywrightTests</code> project and they&#x27;re written in C#.</p><p><a href="https://playwright.dev" target="_blank" rel="noopener noreferrer">Playwright</a> can be used to automate testing of web apps using real browsers. The tests in the example use Chrome (Chromium), but Playwright also supports Firefox, WebKit, and Microsoft Edge.</p><p>This is an example of a Playwright test in C#. It navigates the browser to the app&#x27;s homepage, clicks on the &quot;Fetch data&quot; link, and confirms that the data is fetched from the backend API and it is rendered successfully.</p><div class="language-csharp codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-csharp codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">[Test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public async Task ShouldLoadWeather()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await using var browser = await Playwright.Chromium.LaunchAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var page = await browser.NewPageAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await GoToHomePage(page);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await page.ClickAsync(&quot;a[href=&#x27;fetchdata&#x27;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var h1 = await page.QuerySelectorAsync(&quot;div#app main h1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var h1Text = h1 == null ? &quot;&quot; : await h1.TextContentAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Assert.AreEqual(&quot;Weather forecast&quot;, h1Text);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var rowsSelector = &quot;div#app main table tbody tr&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // wait for table to have rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await page.WaitForFunctionAsync($&quot;document.querySelectorAll(&#x27;{rowsSelector}&#x27;).length&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var rows = await page.QuerySelectorAllAsync(rowsSelector);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Assert.AreEqual(5, rows.Count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The tests use the <code>AZURESTATICWEBAPP_STATIC_WEB_APP_URL</code> environment variable to determine the URL of the app to test. In an Azure Pipeline, this variable is set by the Azure Static Web Apps task after a successful deployment. Because the tests run in the pipeline after a deployment to the staging environment, the variable contains the URL of the staging Static Web Apps environment.</p><p>Another interesting aspect of the tests is the following code for navigating to the homepage:</p><div class="language-csharp codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-csharp codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">private async Task GoToHomePage(IPage page)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await page.GotoAsync($&quot;{siteBaseUrl}/&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var homePageLocatorTask = page.Locator(&quot;text=Hello, world!&quot;).WaitForAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var passwordPageLocatorTask = page.Locator(&quot;text=Password protected&quot;).WaitForAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var isPasswordPage = (await Task.WhenAny(homePageLocatorTask, passwordPageLocatorTask)) == passwordPageLocatorTask;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (isPasswordPage)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.Console.WriteLine(&quot;Found password page, logging in...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var passwordInput = await page.QuerySelectorAsync(&quot;input[type=password]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (passwordInput == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new Exception(&quot;Could not find password input&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await passwordInput.TypeAsync(sitePassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await page.ClickAsync(&quot;button&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await page.Locator(&quot;text=Hello, world!&quot;).WaitForAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This code automatically logs in to the staging environment if the browser session is unauthenticated. At run-time, the <code>sitePassword</code> variable is set to the value of the <code>LOGIN_PASSWORD</code> secret variable.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>With the addition of features like named preview environments and automatic pipeline generation, it&#x27;s now possible to configure complex, robust pipelines for building and deploying to Azure Static Web Apps from Azure DevOps.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">​</a></h2><p>The demo uses a .NET 6 full-stack application with a Blazor WebAssembly frontend, an Azure Functions backend, and integrated Playwright tests. </p><ul><li>Explore <a href="https://github.com/anthonychu/swa-devops-pipeline-demo" target="_blank" rel="noopener noreferrer">the source code here</a>.</li><li>Import the repository into your Azure DevOps project and follow the tutorial.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">​</a></h2><ul><li><a href="https://youtu.be/4JkfeZp7aDk" target="_blank" rel="noopener noreferrer">Video</a>: Multi-environment deployments with Azure DevOps &amp; SWA</li><li><a href="https://github.com/anthonychu/swa-devops-pipeline-demo" target="_blank" rel="noopener noreferrer">Repo</a> with source code for demo</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/swa">swa</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/30-days">30days</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/dev-tools">dev-tools</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about #17: Multi-Stage Deploy with ADO" href="/blog/devtools-ado"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/blog/devtools-playwright">#16: Test Automation with Playwright</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-05-17T00:00:00.000Z" itemprop="datePublished">May 17, 2021</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/nitya" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nitya.png" alt="Nitya Narasimhan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/nitya" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nitya Narasimhan</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Cloud Advocate @Microsoft</small></div></div></div><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://github.com/debs-obrien" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/debs-obrien.png" alt="Debbie O&#x27;Brien"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/debs-obrien" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Debbie O&#x27;Brien</span></a></div><small class="avatar__subtitle" itemprop="description">Senior PM @Microsoft @Playwright</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Welcome to <code>Week 3, Day 2</code> of <strong>#30DaysOfSWA</strong>!! </p><p>Yesterday we kicked off &quot;Developer Tools&quot; week by talking about the end-to-end developer experience associated with building modern web applications. Today we focus on a key segment - <strong>testing</strong>. Let&#x27;s look at what test automation means for modern web applications, and how <a href="https://www.playwright.dev" target="_blank" rel="noopener noreferrer">Playwright</a> can help you automate end-to-end testing of your Azure Static Web App.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-well-cover">What We&#x27;ll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">​</a></h2><ul><li>Test Automation for Modern Web Apps</li><li>What is Playwright?</li><li>Get Started With Playwright</li><li>Explore Playwright Tools</li><li>Use Playwright with SWA</li><li><strong>Exercise</strong>: Try the Tutorial with <strong>your</strong> deployed app.</li></ul><p><img loading="lazy" src="/assets/images/16-banner-4b5207bc5611f5472bf29b8cca5a60af.png" width="1000" height="420" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="test-automation">Test Automation<a class="hash-link" href="#test-automation" title="Direct link to heading">​</a></h2><p>Modern mobile web applications have to work correctly and consistently across all modern browsers (like Chromium, Firefox or WebKit) and the device platforms they run on (with varying screen sizes, orientations). Testing your application UI/UX <strong>manually</strong> becomes difficult when we think about the granularity of tests across these combinations. Testing manually becomes impossible when we factor in the frequency at which testing needs to be done to validate these on every code commit or pull request. This is where test automation shines!</p><p>Test Automation is about executing tests <strong>automatically</strong> to validate software specs, then using the reported insights to improve software quality iteratively. For web apps, this requires tools that can <em>automate test actions in the browser</em> (web automation) and support this consistently <em>across browsers</em>. <strong><a href="https://www.playwright.dev" target="_blank" rel="noopener noreferrer">This is where Playwright shines!</a></strong></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="playwright-overview">Playwright Overview<a class="hash-link" href="#playwright-overview" title="Direct link to heading">​</a></h2><p>Playwright is an open-source framework for <strong>reliable</strong> end-to-end testing of modern web apps. It features a built-in <a href="https://playwright.dev/docs/1.21/intro" target="_blank" rel="noopener noreferrer">Playwright Test Runner</a> for automating test execution, and supports a <a href="https://playwright.dev/docs/1.21/library" target="_blank" rel="noopener noreferrer">Playwright Library</a> to simplify integration into third-party solutions.</p><p><img loading="lazy" alt="Visual Guide to Playwright" src="/assets/images/16-playwright-564feddda5d05dfe978b479e64bed2f2.jpg" width="3840" height="2160" class="img_E7b_"></p><p>This visual guide shows the key features of the framework (<a href="https://github.com/SketchTheDocs/cloud-skills/blob/main/gallery/Playwright-03-Overview.png" target="_blank" rel="noopener noreferrer">downloadable hi-res version here</a>) with these useful features:</p><ul><li><strong>Unified API</strong> - you write tests once, they run on all browsers and devices.</li><li><strong>Mobile Web Testing</strong> - rich set of device profiles, usable with native emulators.</li><li><strong>Multi-Language Support</strong> -  write tests in Java, JS/TS, Python or C#.</li><li><strong>Reliable Testing</strong> - no flaky tests thanks to auto-waiting and web-first assertions</li><li><strong>Powerful Tooling</strong> - get help authoring, debugging, profiling, and reporting, tests.</li><li><strong>Full Isolation</strong> - browser contexts (in just ms), options to parallelize tests</li></ul><p>Check out the Playwright <a href="https://playwright.dev/docs/1.21/intro" target="_blank" rel="noopener noreferrer">documentation</a> and <a href="https://playwright.dev/docs/1.21/api/class-playwright" target="_blank" rel="noopener noreferrer">API</a> for more details. </p><p><strong>What kinds of things can we test with Playwright?</strong> </p><ul><li>Test if UI component behaviors work as expected (events)</li><li>Test if UI workflows are correct (navigation, inputs)</li><li>Test UX behaviors in different contexts (with fixtures)</li><li>Modify network traffic (auth, proxy etc.) for testing</li><li>Validate behaviors under network conditions (modified)</li><li>Validate behaviors for device contexts (emulated profiles)</li><li>Automate capture of evidence (videos, screenshots) in tests</li></ul><p>Explore the <strong><a href="https://playwright.dev/docs/1.21/library" target="_blank" rel="noopener noreferrer">Guides</a></strong> and <strong><a href="https://github.com/MarcusFelling/Demo.Playwright#run-playwright-example-tests" target="_blank" rel="noopener noreferrer">Demo.Playwright</a></strong> for usage examples. And check out <strong><a href="https://dev.to/debs_obrien/series/17445" target="_blank" rel="noopener noreferrer">Debbie&#x27;s playwright-testing</a></strong> series for more examples of Playwright in action.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="playwright-quickstart">Playwright Quickstart<a class="hash-link" href="#playwright-quickstart" title="Direct link to heading">​</a></h2><p>It&#x27;s time to get some hands-on experience with Playwright. Check out the <a href="https://playwright.dev/docs/1.21/intro" target="_blank" rel="noopener noreferrer">Getting Started</a> guide on their site for reference. </p><p>However, we&#x27;d like to walkthrough it with a real-world example in mind and figure out how to go from the boilerplate setup to the start of a basic script and configuration that sets us up to do more for testing our Azure Static App.</p><p><strong>#30DaysOfSWA Website Example: Step-by-Step Tutorial</strong>: </p><p>Check out <a href="https://github.com/fearlessly-dev/30daysofSWA-testing" target="_blank" rel="noopener noreferrer">this repository</a> that I setup today, to use the quickstart guide as a basis for setting up end-to-end testing for the <a href="https://aka.ms/30DaysOfSWA" target="_blank" rel="noopener noreferrer">#30DaysOfSWA</a> website! The <a href="https://github.com/fearlessly-dev/30daysofSWA-testing" target="_blank" rel="noopener noreferrer">README</a> documents the following steps in detail:</p><ul><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#2-where-should-my-tests-be" target="_blank" rel="noopener noreferrer">Setup Testing Repo</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#3-how-do-i-install-playwright" target="_blank" rel="noopener noreferrer">Install Playwright</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#4-what-did-the-installation-do" target="_blank" rel="noopener noreferrer">Explore Boilerplate (setup)</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#5-what-can-i-do-with-this" target="_blank" rel="noopener noreferrer">Run Default Test</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#6-what-does-the-report-show" target="_blank" rel="noopener noreferrer">View Generated Test Report</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#7-what-about-those-github-actions" target="_blank" rel="noopener noreferrer">Automate Tests with GitHub Actions</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing#8-viewing-actions-generated-reports" target="_blank" rel="noopener noreferrer">View Actions-Generated Report Assets</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing/blob/main/README.md#9-lets-customize-the-script" target="_blank" rel="noopener noreferrer">Customize Default Script/Config for <em>My</em> App</a></li><li><a href="https://github.com/fearlessly-dev/30daysofSWA-testing/blob/main/README.md#the-joys-of-trace-logs" target="_blank" rel="noopener noreferrer">The Joy Of Trace Logs!!</a></li><li><strong>You Did It!</strong></li></ul><p>By the end of this tutorial you should have:</p><ul><li>A starter test script customized for <strong>your</strong> application</li><li>A test configuration file <strong>with tracing on</strong> to capture detailed profiling data</li><li>A GitHub Actions workflow that <strong>automates test runs</strong> with each codebase change.</li></ul><p><img loading="lazy" src="https://github.com/fearlessly-dev/30daysofSWA-testing/raw/main/my-report-detail.png" alt="Test Run Report" class="img_E7b_"></p><p>At this point, you are now ready to build on this:</p><ul><li>add more tests to your <code>example.spec.js</code> file =&gt; <strong>see: <a href="https://playwright.dev/docs/test-annotations" target="_blank" rel="noopener noreferrer">Playwright Test API</a></strong></li><li>configure your test run in <code>playwright.config.js</code>. =&gt; <strong>see:<a href="https://playwright.dev/docs/test-configuration" target="_blank" rel="noopener noreferrer">Configuration Object</a></strong></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="playwright-tooling">Playwright Tooling<a class="hash-link" href="#playwright-tooling" title="Direct link to heading">​</a></h2><p>In the tutorial above, we mentioned some Playwright tools (CLI, TraceViewer, HTML Reporter, Codegen) in passing. Playwright has a really powerful set of tools that can streamline your end-to-end testing experience from <em>authoring</em> to <em>reporting</em>. </p><p><strong>Start by familiarizing yourself with the <a href="https://playwright.dev/docs/cli" target="_blank" rel="noopener noreferrer">Playwright CLI</a></strong>. </p><p>It&#x27;s the main launching pad for all other command-line utilities. Using the CLI you can navigate to pages (<em>&quot;open&quot;</em>), install browser dependencies (<em>&quot;install&quot;</em>), take screenshots (<em> &quot;screenshot&quot;</em>), launch the test runner (<em>&quot;test&quot;</em>), author tests (<em>&quot;codegen&quot;</em>), view traces (<em>&quot;show-trace&quot;</em>) and more. </p><p>Launch the CLI as follows:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">npx playwright &lt;command&gt; [options]</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use <code>npx playwright --help</code> for details on commands and options supported in your installed CLI version. Want a deeper dive?</p><ul><li>Check out Nitya&#x27;s <strong><a href="https://dev.to/azure/005-tool-talk-hello-command-line-faj" target="_blank" rel="noopener noreferrer">Tool Talk Post</a></strong> for detailed coverage.</li><li>Download this handy <strong><a href="https://cloud-skills.dev/gallery/Playwright-01-CommandLine.png" target="_blank" rel="noopener noreferrer">hi-res visual guide</a></strong> as a cheatsheet</li></ul><p><strong>Usage Example</strong>: </p><p>Let&#x27;s use the <code>screenshot</code> command to capture an image of the kickoff post from the #30DaysOfSWA website for an &quot;iPhone 6&quot; device profile. You can see the <a href="https://github.com/microsoft/playwright/blob/f1307f4a4d92490d7d0e7ee5a6a7fe9a22804e86/packages/playwright-core/src/server/deviceDescriptorsSource.json" target="_blank" rel="noopener noreferrer">named device profiles</a> currently supported for reference.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">npx playwright screenshot --device &quot;iPhone 6&quot; https://www.azurestaticwebapps.dev/blog/kickoff 30Days.png</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Navigating to https://www.azurestaticwebapps.dev/blog/kickoff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Capturing screenshot into 30Days.png</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th align="left"><strong>Result:</strong> This is what the saved image looks like.</th></tr></thead><tbody><tr><td align="left"><img loading="lazy" alt="Screenshot" src="/assets/images/30Days-35c58c6fb6d68f4828961abf4865a1b9.png" width="750" height="1334" class="img_E7b_"></td></tr></tbody></table><p><strong>Then start exploring these tools</strong>: </p><ul><li><a href="https://playwright.dev/docs/inspector" target="_blank" rel="noopener noreferrer">Inspector</a> - a GUI-based tool for debugging test execution</li><li><a href="https://playwright.dev/docs/trace-viewer" target="_blank" rel="noopener noreferrer">TraceViewer</a> - a GUI-based tool to explore recorded test traces</li><li><a href="https://playwright.dev/docs/codegen" target="_blank" rel="noopener noreferrer">Codegen</a> - an authoring tool to generate tests based on user interactions</li><li><a href="https://playwright.dev/docs/debug" target="_blank" rel="noopener noreferrer">Debugging</a> - additional tools to support runtime debugging</li><li><a href="https://playwright.dev/docs/test-reporters" target="_blank" rel="noopener noreferrer">Reporters</a> - built-in reporters of different types</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="whats-next">What&#x27;s Next<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>We covered a lot today. </p><p>At this point, you should know what Playwright its, and why it&#x27;s useful for automating tests for  modern web applications. You should have a sense of the powerful developer tools it has, and understand how to setup and configure it for use with your Azure Static Web App. And you should have a clean basis for building up your test suite.</p><p>So where can we go next to skill up? We have you covered:</p><ul><li><p><strong><a href="https://github.com/fearlessly-dev/30daysofSWA-testing" target="_blank" rel="noopener noreferrer">Watch this repository</a></strong> I setup today. I hope to continue adding more tests that can walk through various Playwright features with a deployed SWA,, and use that to explore both the Playwright capabilities and SWA-specific features or usage.</p></li><li><p><strong>Join us tomorrow</strong> when we explore a &quot;Multi-Stage Deployment with Azure DevOps&quot; demo that shows you a full-stack application with Playwright tests integrated. Learn interesting aspects - like using SWA environment variables to define test parameters - that highlight best practices for test setup in SWA.</p></li><li><p><strong>Last but not least</strong>, check out this talk from last year for more insights into End-to-End Testing for Playwright from the Azure Static Web Apps Team.</p><iframe width="560" height="315" frameborder="0" src="https://aka.ms/docs/player?ev=learn-tv-static-web-apps-code-to-scale&amp;session=end-to-end-testing-with-playwright"></iframe></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">​</a></h2><p>Pick one of the apps you&#x27;ve built (or use) - preferably one that is currently deployed to Azure Static Web Apps so you can explore other scenarios later.</p><p><a href="https://github.com/fearlessly-dev/30daysofSWA-testing" target="_blank" rel="noopener noreferrer">Walk through the same steps</a> with <strong>your</strong> deployed app - then try adding one new test script that goes beyond the starter test case. Look at the <a href="https://github.com/MarcusFelling/Demo.Playwright" target="_blank" rel="noopener noreferrer">demo</a> project for inspiration!</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/swa">swa</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/30-days">30days</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/dev-tools">dev-tools</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/playwright">playwright</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about #16: Test Automation with Playwright" href="/blog/devtools-playwright"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/blog/devtools-azure">#15: Develop with Azure Tools</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-05-16T00:00:00.000Z" itemprop="datePublished">May 16, 2021</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/nitya" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nitya.png" alt="Nitya Narasimhan"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/nitya" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nitya Narasimhan</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Cloud Advocate @Microsoft</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Welcome to <code>Week 3, Day 1</code> of <strong>#30DaysOfSWA</strong>!! </p><p>We just crossed the halfway mark on #30DaysOfSWA! We covered core concepts in Week 1, and explored usage examples in Week 2. Today we kick off week 3 with a focus on <strong><em>Developer Tools</em>!</strong> Let&#x27;s dive in!</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-well-cover">What We&#x27;ll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">​</a></h2><ul><li>What does the Developer Experience look like?</li><li>Explore: Azure CLI</li><li>Explore: Azure Portal</li><li>Explore: Azure Core Functions Tools</li><li><strong>Exercise:</strong> Explore Azure Portal &amp; CLI docs for SWA.</li></ul><p><img loading="lazy" src="/assets/images/15-banner-c7b1865240e4a1582235f3859f025ac5.png" width="1000" height="420" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dev-experience">Dev Experience<a class="hash-link" href="#dev-experience" title="Direct link to heading">​</a></h2><p>When we think about building a modern web application, we&#x27;re also thinking about our <em>developer experience</em>. By <a href="https://microsoft.github.io/code-with-engineering-playbook/developer-experience/#defining-end-to-end" target="_blank" rel="noopener noreferrer">one definition</a>, developer experience refers to how easy or difficult it is for us, as developers, to perform the required tasks to implement the desired outcome. </p><p>In the case of application development, the tasks often involve:</p><ul><li><strong>Building</strong> the project from source (after creating the codebase)</li><li><strong>Testing</strong> project behaviors (to validate compliance with requirements)</li><li><strong>Deploying</strong> the project (to staging or production environments)</li><li><strong>Debugging</strong> the project (to fix issues, audit performance etc.)</li></ul><p>Having the right <strong>developer tools</strong> can make all the difference between a productive developer workflow and a painful one. This week, we&#x27;ll look at the many tools and services available, that make the Azure Static Web Apps Developer Experience more seamless.</p><ul><li><strong>Azure Dev Tools |</strong> What are the core tools for working with Azure?</li><li><strong>Playwright |</strong> How can we implement end-to-end testing for our app?</li><li><strong>CI/CD|</strong> How can we automate build/deploy workflows?</li><li><strong>Edge DevTools</strong> How can we debug and profile apps in the browser?</li><li><strong>SWA CLI</strong> How can we simplify local development for static web apps?</li><li><strong>Visual Studio Code</strong> How can we supercharge our IDE-driven experience?</li></ul><p>In today&#x27;s post we&#x27;ll look at the main tools that make it easy for modern web application developers to build static web apps on Azure:</p><ul><li><a href="https://docs.microsoft.com/en-us/cli/azure/" target="_blank" rel="noopener noreferrer">Azure CLI</a> - a command-line interface to create and manage Azure resources</li><li><a href="https://docs.microsoft.com/en-us/azure/azure-portal/" target="_blank" rel="noopener noreferrer">Azure Portal</a> - a web-based unified console alternative to the Azure CLI.</li><li><a href="https://github.com/Azure/static-web-apps-cli" target="_blank" rel="noopener noreferrer">Azure SWA CLI</a> - a <em>local development tool</em> for Azure Static Web Apps</li><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a> - a <em>local development tool</em> for Azure Functions.</li><li><a href="https://code.visualstudio.com/docs/azure/extensions" target="_blank" rel="noopener noreferrer">Azure Extensions for Visual Studio Code</a> for seamless access from IDE.</li></ul><p>We&#x27;ll coverAzure SWA CLI and VS Code extensions in greater detail later this week. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="new-to-azure">New to Azure?<a class="hash-link" href="#new-to-azure" title="Direct link to heading">​</a></h2><p>We assume you are familiar with cloud computing concepts like resources, resource groups, subscriptions and services. If not, that&#x27;s okay. Now&#x27;s a good time to take a detour and explore <strong><a href="https://docs.microsoft.com/en-us/learn/paths/az-900-describe-cloud-concepts/" target="_blank" rel="noopener noreferrer">Azure Fundamentals</a></strong> - a 6-part learning series that will take you through the core concepts, services, solutions, security features, identity &amp; governance aspects, and cost management features available on Azure. </p><p>If you&#x27;re a JavaScript or Node.js developer new to Azure, bookmark these links:</p><ul><li><a href="https://azure.github.io/azure-sdk/releases/latest/js.html" target="_blank" rel="noopener noreferrer">Azure SDKs</a> for service integrations in your preferred programming language.</li><li><a href="https://docs.microsoft.com/en-us/azure/developer/javascript/" target="_blank" rel="noopener noreferrer">Azure for JavaScript Developers</a> for guides and samples</li><li><a href="https://docs.microsoft.com/en-us/azure/developer/javascript/node-azure-tools" target="_blank" rel="noopener noreferrer">Tools for JS Developers on Azure</a> with <a href="https://docs.microsoft.com/en-us/azure/developer/javascript/core/configure-local-development-environment?tabs=bash" target="_blank" rel="noopener noreferrer">configuration tips</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="azure-cli">Azure CLI<a class="hash-link" href="#azure-cli" title="Direct link to heading">​</a></h2><p>Now that you&#x27;re familiar with core Azure concepts, let&#x27;s talk about how you can <em>create and manage</em> your cloud resources on Azure. The <strong><a href="https://docs.microsoft.com/en-us/cli/azure/what-is-azure-cli" target="_blank" rel="noopener noreferrer">Azure CLI</a></strong> is a <em>cross-platform</em> command-line tool that connects you securely to Azure, to execute commands on Azure resources interactively (or via scripts) from a terminal.</p><p>The easiest way to familiarize yourself with the Azure CLI commands is to <a href="https://docs.microsoft.com/en-us/cli/azure/get-started-with-azure-cli#install-or-run-in-azure-cloud-shell" target="_blank" rel="noopener noreferrer">install and run it in Azure Cloud Shell</a> <strong>in your browser</strong> - no local installation needed. Follow <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">these instructions</a> to then install it locally in your development environment. Validate your install by testing out the core <code>az</code> command.</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">az --version</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There Azure CLI can manage most Azure Services out of the box. Here is <strong><a href="https://docs.microsoft.com/en-us/cli/azure/azure-services-the-azure-cli-can-manage" target="_blank" rel="noopener noreferrer">list of supportred services</a></strong> along with links to quickstart documentation for each. As web developers, you may find the <strong><a href="https://docs.microsoft.com/en-us/cli/azure/azure-services-the-azure-cli-can-manage#web" target="_blank" rel="noopener noreferrer">web-related subset of services</a></strong> worth exploring - everything from App Service and API Management, to Azure Static Web Apps.</p><p>Use the following command to get interactive help with supported commands and options in this context.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">az staticwebapp --help</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the CLI you can manage app settings, create and delete static apps, manage the static app&#x27;s environment and associated functions, oversee information related to identity, users and secrets associated with the app, and more.</p><ul><li>Explore the <strong><a href="https://docs.microsoft.com/en-us/cli/azure/staticwebapp?view=azure-cli-latest" target="_blank" rel="noopener noreferrer">az staticwebapp</a></strong> reference to learn relevant commands and options.</li><li>Then <strong><a href="https://docs.microsoft.com/en-us/azure/static-web-apps/get-started-cli?tabs=vanilla-javascript" target="_blank" rel="noopener noreferrer">build your first static web app</a></strong> using the Azure CLI.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="azure-portal">Azure Portal<a class="hash-link" href="#azure-portal" title="Direct link to heading">​</a></h2><p>If you prefer a unified web-based console for managing your Azure resource interactions, the <a href="https://docs.microsoft.com/en-us/azure/azure-portal/" target="_blank" rel="noopener noreferrer">Azure Portal</a> provides a <strong>graphical user interface alternative to the Azure CLI</strong>. The portal is designed for <em>continuous availability</em>. Here&#x27;s a snapshot of what the Azure Portal layout looks like. Browse the following documents to get a deeper dive into its capabilities:</p><ul><li>Understand the <a href="https://docs.microsoft.com/en-us/azure/azure-portal/azure-portal-overview#getting-around-the-portal" target="_blank" rel="noopener noreferrer">components of the Azure Portal</a> in this document.</li><li>Then learn to <a href="https://docs.microsoft.com/en-us/learn/modules/tour-azure-portal/3-navigate-the-portal" target="_blank" rel="noopener noreferrer">navigate the portal</a> in this tutorial.</li><li>Or follow the <a href="https://docs.microsoft.com/en-us/azure/azure-portal/azure-portal-quickstart-center" target="_blank" rel="noopener noreferrer">Azure Quickstart Center</a> guided tour.</li></ul><p>Then, try to  <strong><a href="https://docs.microsoft.com/en-us/azure/static-web-apps/get-started-portal?tabs=vanilla-javascript" target="_blank" rel="noopener noreferrer">build your first static web app</a></strong> using the Azure Portal to get hands-on experience with the developer workflow from creation to deployment.</p><p><img loading="lazy" src="https://docs.microsoft.com/en-us/learn/modules/tour-azure-portal/media/3-portal.png" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="functions-core-tools">Functions Core Tools<a class="hash-link" href="#functions-core-tools" title="Direct link to heading">​</a></h2><p>Azure Static Web Apps uses <a href="https://docs.microsoft.com/en-us/azure/azure-functions/" target="_blank" rel="noopener noreferrer">Azure Functions</a> to support serverless API capability for the app. Learn more about this in our earlier post on <a href="/blog/api-enabling-swa">API-enabling SWA</a> where we talked about  <em>Managed Functions</em> (created and managed by Azure Static Web Apps) and <em>Bring Your Own Functions</em> (independently created and managed) options for adding serverless API support to your static web application.</p><p>The <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cmacos%2Ccsharp%2Cportal%2Cbash#install-the-azure-functions-core-tools" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a> - aka <code>func</code> - supports <strong>local development</strong> with a command-line tool to create, test, and even deploy, your functions to Azure. Once installed, use the following to get interactive help with the supported commands and options for this tool:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">func --help</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see something like this <strong>(some output abbreviated for clarity)</strong> giving you a sense of the main operations you can perform from this CLI.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">Azure Functions Core Tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core Tools Version:       4.0.3971 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function Runtime Version: 4.0.1.16815</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: func [context] [context] &lt;action&gt; [-/--options]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contexts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">azure       Commands to log in to Azure and manage resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">durable     Commands for working with Durable Functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extensions  Commands for installing extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function    Commands for creating and running functions locally</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host        Commands for running the Functions host locally</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubernetes  Commands for working with Kubernetes and Azure Functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">settings    Commands for managing environment settings for the local Functions host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">templates   Commands for listing available function templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Actions: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start   Launches the functions runtime host  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --port [-p]     Local port to listen on. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Default: 7071</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">..</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Explore the documentation to learn how you can:</p><ul><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Install the Azure Functions Core Tools</a></li><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cmacos%2Ccsharp%2Cportal%2Cbash#create-a-local-functions-project" target="_blank" rel="noopener noreferrer">Create a local Functions project</a></li><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cmacos%2Ccsharp%2Cportal%2Cbash#start" target="_blank" rel="noopener noreferrer">Run and test Functions locally</a></li><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cmacos%2Ccsharp%2Cportal%2Cbash#publish" target="_blank" rel="noopener noreferrer">Publish Functions to Azure</a></li></ul><p>Later this week, we&#x27;ll do a deep-dive into the <strong><a href="https://github.com/Azure/static-web-apps-cli" target="_blank" rel="noopener noreferrer">Azure Static Web Apps CLI</a></strong> - a local development commandline tool for Azure Static Web Apps, that works seamlessly with the Azure Functions Core Tool, to deliver an unified developer experience for creating and testing your API-enabled Static Web Apps projects.</p><p>The combination of <strong>Azure CLI</strong> (to manage Azure resources from command line), <strong>Azure Functions Core Tools</strong> (to manage Azure Functions local development and deploy) and <strong>Azure Static Web Apps CLI</strong> (to manage SWA local development and deploy) provides a seamless command-line driven developer experience for web developers on Azure.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="azure-extensions">Azure Extensions<a class="hash-link" href="#azure-extensions" title="Direct link to heading">​</a></h2><p>But what if you prefer an IDE-based approach? Visual Studio Code has you covered. In a post Later this week, we&#x27;ll look in depth at the key Visual Studio Code Extensions you can use, to supercharge your developer experience from code to cloud, right inside the IDE. For now, I&#x27;ll leave you with these resources:</p><ul><li>Read the <a href="https://code.visualstudio.com/docs/azure/extensions" target="_blank" rel="noopener noreferrer">Azure Extensions</a> documentation to learn how to find, and install, relevant extensions in VS Code.</li><li>Explore the <a href="https://code.visualstudio.com/docs/azure/deployment" target="_blank" rel="noopener noreferrer">Deploying Applications To Azure</a> page for hands-on tutorials for VS Code - including one for <a href="https://docs.microsoft.com/en-us/azure/static-web-apps/getting-started?tabs=vanilla-javascript" target="_blank" rel="noopener noreferrer">Azure Static Web Apps</a> and one for <a href="https://docs.microsoft.com/azure/javascript/tutorial-vscode-serverless-node-01" target="_blank" rel="noopener noreferrer">Azure Functions</a></li><li>Search the <a href="https://marketplace.visualstudio.com/search?term=Microsoft&amp;target=VSCode&amp;category=Azure&amp;sortBy=Relevance" target="_blank" rel="noopener noreferrer">VS Code Marketplace</a> for relevant extensions from both Microsoft and the broader developer community.</li></ul><p>Here is a snapshot of extensions currently published by <strong>Microsoft</strong> in the <strong>Azure</strong> category, sorted by <strong>Trending</strong> metrics. You can see the <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestaticwebapps" target="_blank" rel="noopener noreferrer">Azure Static Web Apps Extension</a> listed here -- we&#x27;ll cover that in more detail in the final post of this week!</p><p><img loading="lazy" src="/assets/images/15-extensions-a89bcb9f9f2882e54a019d3219040785.png" width="1224" height="1014" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">​</a></h2><p>Wow - we covered a lot today!! But don&#x27;t worry about having to remember all of it. The goal was to raise awareness of <em>which</em> tool to use, <em>when</em>, and <em>why</em>. Your exercise today:</p><ul><li><p>pick either <strong>Azure Portal</strong> or <strong>Azure CLI</strong> documentation for Azure Static Web Apps, and familiarize yourself with the many commands, settings and options available. </p></li><li><p>Try the default quickstart for that option - then explore other commands with the deployed Static Web App to get a real sense of how this works.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">​</a></h2><ul><li><a href="https://docs.microsoft.com/en-us/cli/azure/" target="_blank" rel="noopener noreferrer">Azure CLI</a> documentation - with <a href="https://docs.microsoft.com/en-us/azure/static-web-apps/get-started-cli?tabs=vanilla-javascript" target="_blank" rel="noopener noreferrer">Static Web Apps Quickstart</a></li><li><a href="https://docs.microsoft.com/en-us/azure/azure-portal/" target="_blank" rel="noopener noreferrer">Azure Portal</a> documentation - with <a href="https://docs.microsoft.com/en-us/azure/static-web-apps/get-started-portal?tabs=vanilla-javascript" target="_blank" rel="noopener noreferrer">Static Web Apps Quickstart</a></li><li><a href="https://github.com/Azure/static-web-apps-cli" target="_blank" rel="noopener noreferrer">Azure SWA CLI</a> documentation</li><li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a> documentation</li><li><a href="https://azure.github.io/azure-sdk/releases/latest/js.html" target="_blank" rel="noopener noreferrer">Azure SDKs</a> for JavaScript and other languages</li><li><a href="https://code.visualstudio.com/docs/azure/extensions" target="_blank" rel="noopener noreferrer">Azure Extensions for Visual Studio Code</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/swa">swa</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/30-days">30days</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/dev-tools">dev-tools</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about #15: Develop with Azure Tools" href="/blog/devtools-azure"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Microsoft - Built by <a href="https://github.com/nitya"> @nitya </a> with ❤️ &nbsp; using Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0dd7f00d.js"></script>
<script src="/assets/js/main.29edfaee.js"></script>
</body>
</html>